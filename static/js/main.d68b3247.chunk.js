(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{147:function(e,t,n){},148:function(e,t,n){"use strict";n.r(t);n(78),n(103);var a=n(0),r=n.n(a),c=n(19),i=n.n(c),l=n(28),o=n.n(l),s=n(10),u=n(11),p=n(13),h=n(12),d=n(14),m=n(2),f=n(1),b=(n(125),n(72)),v=n.n(b),E=n(73),g=n.n(E),O=n(8),y=n.n(O),S=n(17),j=n(27),k=n.n(j),P=n(20),C=n.n(P);function A(e){var t=new Date(1e3*e),n=t.getFullYear(),a=["\u042f\u043d\u0432\u0430\u0440\u044f","\u0424\u0435\u0432\u0440\u0430\u043b\u044f","\u041c\u0430\u0440\u0442\u0430","\u0410\u043f\u0440\u0435\u043b\u044f","\u041c\u0430\u044f","\u0418\u044e\u043d\u044f","\u0418\u044e\u043b\u044f","\u0410\u0432\u0433\u0443\u0441\u0442\u0430","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u041e\u043a\u0442\u044f\u0431\u0440\u044f","\u041d\u043e\u044f\u0431\u0440\u044f","\u0414\u0435\u043a\u0430\u0431\u0440\u044f"][t.getMonth()];return e=t.getDate()+" "+a+" "+n}var w=n(34),x=(Object(f.platform)(),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).onRefresh=w.makeOnRefresh("profile","get",{},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.state={content:null,activePanel:"main",popout:null,fetching:!1},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"onLoaded",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({content:r.a.createElement(f.Cell,null,r.a.createElement(f.Group,null,r.a.createElement(f.Cell,{size:"l",description:n.nickname,before:t.photo_200?r.a.createElement(f.Avatar,{src:t.photo_200}):null},"".concat(t.first_name," ").concat(t.last_name))),r.a.createElement(f.Group,null,r.a.createElement(f.Cell,{indicator:(a=n.balance,a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" \u0431\u0438\u0442"),description:n.job},"\u0411\u0430\u043b\u0430\u043d\u0441"),r.a.createElement(f.Cell,{indicator:n.level},"\u0423\u0440\u043e\u0432\u0435\u043d\u044c"),r.a.createElement(f.Div,null,r.a.createElement(f.Progress,{value:n.score/n.maxScore*100})))),fetching:!1});case 1:case"end":return e.stop()}var a},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"openSheet",value:function(e){this.setState({popout:e})}},{key:"render",value:function(){return!this.state.content&&this.props.fetchedUser&&w.cSend("profile","get",{},this.props,this.onLoaded.bind(this)),r.a.createElement(f.View,{activePanel:this.state.activePanel,popout:this.state.popout},r.a.createElement(f.Panel,{id:"main"},r.a.createElement(f.PanelHeader,null,"\ud83d\udc64 \u041c\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c"),r.a.createElement(f.PullToRefresh,{onRefresh:this.onRefresh,isFetching:this.state.fetching},this.state.content?this.state.content:r.a.createElement(f.Spinner,{size:"large",style:{marginTop:20}})),r.a.createElement(f.Cell,null,r.a.createElement(f.Group,{title:"\u041f\u0440\u043e\u0447\u0435\u0435"},r.a.createElement(f.Link,{href:"https://vk.com/@evarobotgroup-help-play-app",target:"_blank"},r.a.createElement(f.Button,{size:"xl",level:"outline"},"\u041a\u0430\u043a \u0438\u0433\u0440\u0430\u0442\u044c?")),r.a.createElement(f.Link,{href:"https://vk.com/evabottp",target:"_blank"},r.a.createElement(f.Button,{size:"xl",level:"outline"},"\u0422\u0435\u0445. \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430")),r.a.createElement(f.Link,{href:"https://vk.me/join/AAAAACNkOSYHHwx7BXja6x2c",target:"_blank"},r.a.createElement(f.Button,{size:"xl",level:"outline"},"\u041e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u0430\u044f \u0431\u0435\u0441\u0435\u0434\u0430 \u0431\u043e\u0442\u0430"))))))}}]),t}(r.a.Component)),I=n(75),L=n.n(I),R=n(76),D=n.n(R),B=(n(147),n(34)),T=Object(f.platform)(),z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).feedAction=B.makeAction("pets","feed",{petId:n.props.id},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.playAction=B.makeAction("pets","play",{petId:n.props.id},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.wakeUpAction=B.makeAction("pets","wakeUp",{petId:n.props.id},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.shelterAction=B.makeAction("pets","shelter",{petId:n.props.id},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.openRestorePetSheet=n.openRestorePetSheet.bind(Object(m.a)(Object(m.a)(n))),n.onRefresh=n.onRefresh.bind(Object(m.a)(Object(m.a)(n))),n.state={},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"onRefresh",value:function(){this.setState({fetching:!0}),B.cSend("pets","get",{petId:this.props.id},this.props,this.onLoaded.bind(this))}},{key:"openRestorePetSheet",value:function(){var e=this;this.props.openSheet(r.a.createElement(f.Alert,{actionsLayout:"vertical",actions:[{title:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c",autoclose:!0,action:function(){return B.cSend("pets","restore",{petId:e.props.id},e.props,e.onLoaded.bind(e))}},{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,style:"cancel"}],onClose:function(){return e.props.openSheet(null)}},r.a.createElement("h2",null,"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430"),r.a.createElement("p",null,"\u0412\u044b \u0441\u043d\u043e\u0432\u0430 \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u043b\u044e\u0431\u0438\u0442\u044c \u0438 \u0443\u0445\u0430\u0436\u0438\u0432\u0430\u0442\u044c \u0437\u0430 \u043d\u0438\u043c")))}},{key:"onLoaded",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n){var a,c,i=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded=!0,!n.error){e.next=4;break}return this.props.openSheet(r.a.createElement(f.Alert,{actionsLayout:"vertical",actions:[{title:"\u041d\u0430\u0437\u0430\u0434",autoclose:!0,style:"cancel"}],onClose:function(){return i.props.openSheet(null)}},r.a.createElement("h2",null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"),r.a.createElement("p",null,n.error))),e.abrupt("return");case 4:return e.next=6,B.initPets();case 6:a=B.getPetType(n.type),c=r.a.createElement(f.Div,null,r.a.createElement(f.Group,null,r.a.createElement(f.Cell,{size:"l",before:r.a.createElement(f.Avatar,null,0==n.died?a.smile:"\ud83d\udc80"),description:0==n.died?"":"\u0423\u043c\u0435\u0440 ".concat(A(n.died),"."),indicator:0==n.issleep?"":"\ud83d\udca4"},n.name),0==n.died?r.a.createElement(f.Div,null,0==n.issleep?r.a.createElement(f.Div,{style:{display:"flex"}},r.a.createElement(f.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:this.playAction},"\u041f\u043e\u0438\u0433\u0440\u0430\u0442\u044c"),r.a.createElement(f.Button,{size:"l",stretched:!0,level:"secondary",onClick:this.feedAction},"\u041f\u043e\u043a\u043e\u0440\u043c\u0438\u0442\u044c")):r.a.createElement(f.Button,{size:"xl",level:"outline",onClick:this.wakeUpAction},"\u0420\u0430\u0437\u0431\u0443\u0434\u0438\u0442\u044c"),0==n.owner?r.a.createElement(f.Button,{size:"xl",level:"outline",onClick:this.shelterAction},"\u041a\u0443\u043f\u0438\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430"):""):""),r.a.createElement(f.Group,{title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0435"},0==n.died?r.a.createElement(f.Div,null,r.a.createElement(f.Cell,{indicator:n.hunger+"%"},"\u0421\u044b\u0442\u043e\u0441\u0442\u044c"),r.a.createElement(f.Progress,{value:Math.min(100,n.hunger)}),r.a.createElement(f.Cell,{indicator:n.love+"%"},"\u0421\u0447\u0430\u0441\u0442\u044c\u0435"),r.a.createElement(f.Progress,{value:Math.min(100,n.love)}),r.a.createElement(f.Cell,{indicator:n.energy+"%"},"\u042d\u043d\u0435\u0440\u0433\u0438\u044f"),r.a.createElement(f.Progress,{value:Math.min(100,n.energy)})):r.a.createElement(f.Div,null,r.a.createElement("img",{className:"DiedPet",src:D.a,alt:"Died pet"}),r.a.createElement(f.Div,null,r.a.createElement("p",null,"\u0412\u0430\u0448 \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u0443\u043c\u0435\u0440, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0432\u044b \u0435\u0433\u043e \u043d\u0435 \u043a\u043e\u0440\u043c\u0438\u043b\u0438."),r.a.createElement(f.CellButton,{onClick:function(){return i.openRestorePetSheet()}},"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0437\u0430 3 000 000 \u0431\u0438\u0442."))))),this.setState({content:c,fetching:!1});case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.content||B.cSend("pets","get",{petId:this.props.id},this.props,this.onLoaded.bind(this)),r.a.createElement(f.Div,null,r.a.createElement(f.PanelHeader,{left:r.a.createElement(f.HeaderButton,{onClick:this.props.close},T===f.IOS?r.a.createElement(k.a,null):r.a.createElement(C.a,null))},this.props.title),r.a.createElement(f.PullToRefresh,{onRefresh:this.onRefresh,isFetching:this.state.fetching},this.state.content?this.state.content:r.a.createElement(f.Spinner,{size:"large",style:{marginTop:20}})))}}]),t}(r.a.Component),U=n(34),G=Object(f.platform)(),_=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getPets",value:function(e){var t=this;this.props.openSheet(r.a.createElement(f.ScreenSpinner,null)),U.send("pets","listFree",{petType:e.id}).then(function(n){var a=n.data.map(function(n){return r.a.createElement(f.ActionSheetItem,{autoclose:!0,onClick:function(){return t.props.openPet(n,e)}},n.name)});t.props.openSheet(r.a.createElement(f.ActionSheet,{onClose:function(){return t.props.openSheet(null)}},a,G===f.IOS&&r.a.createElement(f.ActionSheetItem,{autoclose:!0,theme:"cancel"},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c")))})}},{key:"render",value:function(){var e=this,t=U.getPetTypes().map(function(t){return r.a.createElement(f.ListItem,null,r.a.createElement(f.Cell,{before:r.a.createElement(f.Avatar,null,t.smile),onClick:function(){return e.getPets(t)}},t.mname))});return r.a.createElement(f.Div,null,r.a.createElement(f.PanelHeader,{left:r.a.createElement(f.HeaderButton,{onClick:this.props.close},G===f.IOS?r.a.createElement(k.a,null):r.a.createElement(C.a,null))},"\ud83d\udc36 \u041f\u0440\u0438\u044e\u0442 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432"),r.a.createElement(f.Group,{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0432\u0438\u0434\u043e\u0432"},r.a.createElement(f.List,null,t)))}}]),t}(r.a.Component),H=n(34),V=(Object(f.platform)(),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).openSheet=n.openSheet.bind(Object(m.a)(Object(m.a)(n))),n.onRefresh=H.makeOnRefresh("pets","list",{},Object(m.a)(Object(m.a)(n)),n.onLoaded.bind(Object(m.a)(Object(m.a)(n)))),n.openPet=n.openPet.bind(Object(m.a)(Object(m.a)(n))),n.state={content:null,activePanel:"main",popout:null,fetching:!1},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"openPet",value:function(e,t){var n=this;this.setState({activePanel:"pet",petcontent:r.a.createElement(z,{id:e.id,title:"".concat(t.smile," ").concat(e.name),close:function(){return n.setState({activePanel:"main"})},openSheet:function(e){return n.openSheet(e)}})})}},{key:"onLoaded",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n){var a,c,i=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.initPets();case 2:a=[],n.forEach(function(e){var t=H.getPetType(e.type),n=r.a.createElement(f.Div,{style:{display:"flex",padding:0,margin:0}},r.a.createElement(f.Div,{stretched:!0,style:{padding:10,margin:0}},"\ud83c\udf57 ",e.hunger,"%"),r.a.createElement(f.Div,{stretched:!0,style:{padding:10,margin:0}},"\ud83d\udc96 ",e.love,"%"),r.a.createElement(f.Div,{stretched:!0,style:{padding:10,margin:0}},"\u26a1 ",e.energy,"%"));a.push(r.a.createElement(f.Cell,{before:r.a.createElement(f.Avatar,null,t.smile),size:"l",onClick:function(n){i.setState({activePanel:"pet",petcontent:r.a.createElement(z,{id:e.id,title:"".concat(t.smile," ").concat(e.name),close:function(){return i.setState({activePanel:"main"})},openSheet:function(e){return i.openSheet(e)}})})},indicator:0==e.issleep?"":"\ud83d\udca4",description:0==e.died?n:"\ud83d\udc80 \u0423\u043c\u0435\u0440 ".concat(A(e.died),".")},e.name))}),c=r.a.createElement(f.Div,null,r.a.createElement(f.Group,null,r.a.createElement(f.Link,{href:"https://vk.com/@evarobotgroup-help-pets-app",target:"_blank"},r.a.createElement(f.Button,{size:"xl",level:"outline"},"\u0427\u0442\u043e \u0442\u0430\u043a\u043e\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b?"))),r.a.createElement(f.Group,null,a,r.a.createElement(f.CellButton,{before:r.a.createElement(L.a,null),onClick:function(e){i.setState({activePanel:"shelder"})}},"\u0417\u0430\u0432\u0435\u0441\u0442\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u0430"))),this.setState({content:c,fetching:!1});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"openSheet",value:function(e){this.setState({popout:e})}},{key:"render",value:function(){var e=this;return this.state.content||H.cSend("pets","list",{petId:this.props.id},this.props,this.onLoaded.bind(this)),r.a.createElement(f.View,{id:"petsView",activePanel:this.state.activePanel,popout:this.state.popout},r.a.createElement(f.Panel,{id:"main"},r.a.createElement(f.PanelHeader,null,"\ud83d\udc3e \u041c\u043e\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u044b"),r.a.createElement(f.PullToRefresh,{onRefresh:this.onRefresh,isFetching:this.state.fetching},this.state.content?this.state.content:r.a.createElement(f.Spinner,{size:"large",style:{marginTop:20}}))),r.a.createElement(f.Panel,{id:"pet"},this.state.petcontent),r.a.createElement(f.Panel,{id:"shelder"},r.a.createElement(_,{close:function(){return e.setState({activePanel:"main"})},openSheet:this.openSheet.bind(this),openPet:this.openPet})))}}]),t}(r.a.Component)),F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).parseQueryString=function(e){return e.slice(1).split("&").map(function(e){var t=e.split("=");return{key:t[0],value:t[1]}}).reduce(function(e,t){return e[t.key]=t.value,e},{})},n.getItem=function(e,t,a){return r.a.createElement(f.TabbarItem,{onClick:n.onStoryChange,selected:n.state.activeStory===e,"data-story":e,text:t},a)},n.state={activeStory:"main",fetchedUser:null},n.onStoryChange=n.onStoryChange.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"onStoryChange",value:function(e){this.setState({activeStory:e.currentTarget.dataset.story})}},{key:"componentDidMount",value:function(){var e=this;o.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:t.detail.data});break;default:console.log(t.detail.type)}}),o.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){return r.a.createElement(f.Epic,{activeStory:this.state.activeStory,tabbar:r.a.createElement(f.Tabbar,null,this.getItem("main","\u041f\u0440\u043e\u0444\u0438\u043b\u044c",r.a.createElement(v.a,null)),this.getItem("pets","\u041f\u0438\u0442\u043e\u043c\u0446\u044b",r.a.createElement(g.a,null)))},r.a.createElement(x,{id:"main",fetchedUser:this.state.fetchedUser}),r.a.createElement(V,{id:"pets",fetchedUser:this.state.fetchedUser}))}}]),t}(r.a.Component);o.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppUpdateConfig":var t=document.createAttribute("scheme");t.value=e.detail.data.scheme?e.detail.data.scheme:"client_light",document.body.attributes.setNamedItem(t);break;default:console.log(e.detail.type)}}),o.a.send("VKWebAppInit",{}),i.a.render(r.a.createElement(F,null),document.getElementById("root"))},34:function(e,t,n){"use strict";n.r(t),n.d(t,"send",function(){return h}),n.d(t,"cSend",function(){return d}),n.d(t,"initPets",function(){return m}),n.d(t,"getPetType",function(){return b}),n.d(t,"getPetTypes",function(){return v}),n.d(t,"makeAction",function(){return E}),n.d(t,"makeOnRefresh",function(){return g});var a,r=n(8),c=n.n(r),i=n(17),l=n(0),o=n.n(l),s=n(1),u=n(74),p=n.n(u);function h(e,t,n){return p.a.get("http://elektro-volk.ru/apieva/index.php?group=".concat(e,"&method=").concat(t,"&").concat(window.location.search.substring(1)),{params:n})}function d(e,t,n,a,r){h(e,t,n).then(function(e){return r(a.fetchedUser,e.data)})}function m(){return f.apply(this,arguments)}function f(){return(f=Object(i.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=4;break}return e.next=3,h("pets","types");case 3:a=e.sent.data;case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e){return a[e-1]}function v(){return a}function E(e,t,n,a,r){return function(){a.props.openSheet(o.a.createElement(s.ScreenSpinner,null)),d(e,t,n,a.props,function(e,t){a.props.openSheet(null),r(e,t)})}}function g(e,t,n,a,r){return function(){a.setState({fetching:!0}),d(e,t,n,a.props,function(e,t){r(e,t),a.setState({fetching:!1})})}}},76:function(e,t,n){e.exports=n.p+"static/media/persik.695e98f0.png"},77:function(e,t,n){e.exports=n(148)}},[[77,1,2]]]);
//# sourceMappingURL=main.d68b3247.chunk.js.map